@model CalendarViewModel
@{
    ViewData["Title"] = "Quest Calendar";
}

<div class="row">
    <div class="col-12">
        <div class="card modern-card">
            <div class="card-header modern-card-header d-flex justify-content-between align-items-center">
                <h2 class="mb-0">
                    <i class="fas fa-calendar-alt me-2"></i>
                    Quest Calendar
                </h2>
                <div class="calendar-navigation">
                    <a href="@Url.Action("Index", new { year = Model.FirstDayOfMonth.AddMonths(-1).Year, month = Model.FirstDayOfMonth.AddMonths(-1).Month })" 
                       class="btn btn-outline-primary btn-sm me-2">
                        <i class="fas fa-chevron-left"></i>
                    </a>
                    <span class="fw-bold">@Model.MonthName</span>
                    <a href="@Url.Action("Index", new { year = Model.FirstDayOfMonth.AddMonths(1).Year, month = Model.FirstDayOfMonth.AddMonths(1).Month })" 
                       class="btn btn-outline-primary btn-sm ms-2">
                        <i class="fas fa-chevron-right"></i>
                    </a>
                </div>
            </div>
            <div class="card-body modern-card-body p-0">
                <div class="calendar-grid">
                    <!-- Calendar Header -->
                    <div class="calendar-header">
                        <div class="calendar-day-header">Sunday</div>
                        <div class="calendar-day-header">Monday</div>
                        <div class="calendar-day-header">Tuesday</div>
                        <div class="calendar-day-header">Wednesday</div>
                        <div class="calendar-day-header">Thursday</div>
                        <div class="calendar-day-header">Friday</div>
                        <div class="calendar-day-header">Saturday</div>
                    </div>
                    
                    <!-- Calendar Days -->
                    <div class="calendar-body">
                        @foreach (var day in Model.GetCalendarDays())
                        {
                            <div class="calendar-day @(day.IsEmpty ? "empty" : "") @(day.Date.Date == DateTime.Today ? "today" : "")">
                                @if (!day.IsEmpty)
                                {
                                    <div class="day-number">@day.Day</div>
                                    
                                    @if (day.QuestsOnDay.Any())
                                    {
                                        <div class="quest-events">
                                            @foreach (var questOnDay in day.QuestsOnDay.Take(3))
                                            {
                                                <div class="quest-event @(questOnDay.IsFinalized ? "finalized" : "proposed")" 
                                                     title="@questOnDay.Quest.Title - @questOnDay.ProposedDate.Date.ToString("HH:mm")">
                                                    <a href="@Url.Action("Details", "Quest", new { id = questOnDay.Quest.Id })" 
                                                       class="quest-link">
                                                        <div class="quest-title">@questOnDay.Quest.Title</div>
                                                        <div class="quest-time">@questOnDay.ProposedDate.Date.ToString("HH:mm")</div>
                                                        @if (questOnDay.IsFinalized)
                                                        {
                                                            <i class="fas fa-check-circle finalized-icon"></i>
                                                        }
                                                    </a>
                                                </div>
                                            }
                                            @if (day.QuestsOnDay.Count > 3)
                                            {
                                                <div class="more-events">+@(day.QuestsOnDay.Count - 3) more</div>
                                            }
                                        </div>
                                    }
                                }
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Legend -->
<div class="row mt-4">
    <div class="col-12">
        <div class="card modern-card">
            <div class="card-header modern-card-header">
                <h5 class="mb-0">
                    <i class="fas fa-info-circle me-2"></i>
                    Legend
                </h5>
            </div>
            <div class="card-body modern-card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="d-flex align-items-center mb-2">
                            <div class="legend-item proposed me-2"></div>
                            <span>Proposed Quest Date</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <div class="legend-item finalized me-2"></div>
                            <span>Finalized Quest Date</span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <p class="mb-0">
                            <i class="fas fa-lightbulb me-2"></i>
                            Click on any quest to view details and sign up!
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

